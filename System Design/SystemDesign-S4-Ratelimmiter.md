<!-- language: rtl -->
<div dir="rtl" align="right" >

**ูุตู ด: ุทุฑุงุญ ฺฉ Rate Limiter (ูุญุฏูุฏฺฉููุฏู ูุฑุฎ)**

ุฏุฑ ฺฉ ุณุณุชู ุดุจฺฉูโุงุ *Rate Limiter* (ูุญุฏูุฏฺฉููุฏู ูุฑุฎ) ุจุฑุง ฺฉูุชุฑู ูุฑุฎ ุชุฑุงูฺฉ ฺฉู ุชูุณุท ฺฉ ฺฉุงุฑุจุฑ ุง ฺฉ ุณุฑูุณ ุงุฑุณุงู ูโุดูุฏุ ุงุณุชูุงุฏู ูโฺฏุฑุฏุฏ. ุฏุฑ ุฏูุง HTTPุ ฺฉ Rate Limiter ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ฺฉู ฺฉ ฺฉูุงูุช ูโุชูุงูุฏ ุฏุฑ ฺฉ ุจุงุฒู ุฒูุงู ูุดุฎุต ุงุฑุณุงู ฺฉูุฏ ุฑุง ูุญุฏูุฏ ูโฺฉูุฏ. ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง API ุงุฒ ุขุณุชุงูู ุชุนูโุดุฏู ุชูุณุท Rate Limiter ูุฑุงุชุฑ ุฑูุฏุ ุชูุงู ูุฑุงุฎูุงูโูุง ุงุถุงู ูุณุฏูุฏ ูโุดููุฏ.

### ูุซุงูโูุง ุงุฒ ฺฉุงุฑุจุฑุฏ ูุญุฏูุฏฺฉููุฏู ูุฑุฎ:

* ฺฉ ฺฉุงุฑุจุฑ ููโุชูุงูุฏ ุจุด ุงุฒ **ฒ ูพุณุช ุฏุฑ ูุฑ ุซุงูู** ุงุฑุณุงู ฺฉูุฏ.
* ุงุฒ ฺฉ ุขุฏุฑุณ IP ูุดุฎุตุ ุชููุง ูโุชูุงู **ุญุฏุงฺฉุซุฑ ฑฐ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฏุฑ ฺฉ ุฑูุฒ** ุงุฌุงุฏ ฺฉุฑุฏ.
* ุงุฒ ฺฉ ุฏุณุชฺฏุงู ุฎุงุตุ **ููุท ต ุจุงุฑ ุฏุฑ ููุชู** ูโุชูุงู ูพุงุฏุงุด ุฏุฑุงูุช ฺฉุฑุฏ.

ุฏุฑ ุงู ูุตูุ ุงุฒ ุดูุง ุฎูุงุณุชู ุดุฏู ุชุง ฺฉ ุณุณุชู Rate Limiter ุทุฑุงุญ ฺฉูุฏ. ูพุด ุงุฒ ุดุฑูุน ุทุฑุงุญุ ุงุจุชุฏุง ุจู ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ Rate Limiter ุฏุฑ APIูุง ูโูพุฑุฏุงุฒู:

---

### ูุฒุงุง ุงุณุชูุงุฏู ุงุฒ Rate Limiter:

#### ฑ. **ุฌููฺฏุฑ ุงุฒ Starvation ููุงุจุน ูุงุด ุงุฒ ุญููุงุช DoS (Denial of Service - ุญููู ุงูฺฉุงุฑ ุณุฑูุณ)**

ุชูุฑุจุงู ุชูุงู APIูุง ููุชุดุฑ ุดุฏู ุชูุณุท ุดุฑฺฉุชโูุง ุจุฒุฑฺฏ ููุงูุฑุ ููุน ุงุฒ ูุญุฏูุฏุช ูุฑุฎ ุฑุง ูพุงุฏูโุณุงุฒ ูโฺฉููุฏ. ุจู ุนููุงู ูุซุงู:

* **ุชูุชุฑ** ูุญุฏูุฏุช ุงุฑุณุงู ุชูุช ุฑุง ุจู **ณฐฐ ุชูุช ุฏุฑ ูุฑ ณ ุณุงุนุช** ูุญุฏูุฏ ฺฉุฑุฏู ุงุณุช \[2].
* APIูุง **Google Docs** ุจู ุทูุฑ ูพุดโูุฑุถ ุฏุงุฑุง ูุญุฏูุฏุช **ณฐฐ ุฏุฑุฎูุงุณุช ุฎูุงูุฏู ุฏุฑ ูุฑ ถฐ ุซุงูู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ** ูุณุชูุฏ \[3].

ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ุงุฒ ุจุฑูุฒ ุญููุงุช DoS - ฺู ุนูุฏ ู ฺู ุบุฑุนูุฏ - ุจุง ูุณุฏูุฏ ฺฉุฑุฏู ุฏุฑุฎูุงุณุชโูุง ุงุถุงู ุฌููฺฏุฑ ูโฺฉูุฏ.

๐ **ููุจุน:**

* \[1] OWASP: Rate Limiting โ [https://owasp.org/www-community/Rate\_Limiting](https://owasp.org/www-community/Rate_Limiting)
* \[2] Twitter Rate Limits โ [https://developer.twitter.com/en/docs/twitter-api/rate-limits](https://developer.twitter.com/en/docs/twitter-api/rate-limits)
* \[3] Google Docs API Usage Limits โ [https://developers.google.com/docs/api/limits](https://developers.google.com/docs/api/limits)

---

#### ฒ. **ฺฉุงูุด ูุฒููโูุง**

ูุญุฏูุฏ ฺฉุฑุฏู ุฏุฑุฎูุงุณุชโูุง ุงุถุงู ุจุงุนุซ ูโุดูุฏ ุจู ุชุนุฏุงุฏ ฺฉูุชุฑ ุณุฑูุฑ ูุงุฒ ุจุงุดุฏ ู ููุงุจุน ุจุดุชุฑ ุจู APIูุง ุจุง ุงูููุช ุจุงูุง ุชุฎุตุต ุงุจูุฏ. Rate Limiting ุฏุฑ ุดุฑฺฉุชโูุง ฺฉู ุงุฒ APIูุง ุฎุงุฑุฌ ูพูู ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงููุช ูููโุงูุนุงุฏูโุง ุฏุงุฑุฏ.

ุจุฑุง ูุซุงูุ ุฏุฑ ููุงุฑุฏ ุฒุฑ ุดูุง ุจู ุงุฒุง ูุฑ ูุฑุงุฎูุงู ูุฒูู ูพุฑุฏุงุฎุช ูโฺฉูุฏ:

* ุจุฑุฑุณ ุงุนุชุจุงุฑ ูุดุชุฑ
* ุงูุฌุงู ูพุฑุฏุงุฎุช ุจุงูฺฉ
* ุจุงุฒุงุจ ุณูุงุจู ุณูุงูุช ฺฉุงุฑุจุฑ

ูุญุฏูุฏ ฺฉุฑุฏู ุชุนุฏุงุฏ ูุฑุงุฎูุงูโูุง ุจุฑุง ฺฉุงูุด ูุฒูู ุถุฑูุฑ ุงุณุช.

---

#### ณ. **ุฌููฺฏุฑ ุงุฒ Overload ุดุฏู ุณุฑูุฑูุง**

ุจุฑุง ฺฉุงูุด ุจุงุฑ ุณุฑูุฑูุงุ Rate Limiter ูโุชูุงูุฏ ุฏุฑุฎูุงุณุชโูุง ุงุถุงู ูุงุด ุงุฒ ุฑูุชุงุฑ ูุงููุฌุงุฑ ฺฉุงุฑุจุฑุงู ุง ุฑุจุงุชโูุง ุฑุง ููุชุฑ ฺฉูุฏ. ุงู ฺฉุงุฑ ุจุงุนุซ ูโุดูุฏ ุณุณุชู ุฏุฑ ุดุฑุงุท ุจุงุฑ ุจุงูุง ูุฒ ูพุงุฏุงุฑ ุจุงู ุจูุงูุฏ.

---

๐ **ูฺฉุชู ุชฺฉูู (ุงุถุงูู ุดุฏู ุจุง ุฑูุฑูุณ):**
ุฏุฑ ุณุณุชูโูุง ูุจุชู ุจุฑ ูฺฉุฑูุณุฑูุณโูุงุ ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ูโุชูุงูุฏ ุฏุฑ ูุงูโ *API Gateway* ุง ุจูโุนููุงู ฺฉ *middleware* ูพุงุฏูโุณุงุฒ ุดูุฏ. ุฏุฑ ุณุฑูุณโูุง ูุงููุฏ Amazon API Gateway ุง Kongุ ูุงุจูุช *rate limiting* ุจู ุตูุฑุช ุชูฺฉุงุฑ ูุฌูุฏ ุฏุงุฑุฏ (ููุจุน: *Designing Distributed Systems - Brendan Burns, OโReilly*).

---
# ฺฏุงู ุงูู โ ุฏุฑฺฉ ูุณุฆูู ู ุชุนู ูุญุฏูุฏู ุทุฑุงุญ

ูุญุฏูุฏฺฉููุฏู ูุฑุฎ (Rate Limiter) ุฑุง ูโุชูุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ูุฎุชูู ูพุงุฏูโุณุงุฒ ฺฉุฑุฏ ฺฉู ูุฑฺฉุฏุงู ูุฒุงุง ู ูุนุงุจ ุฎูุฏ ุฑุง ุฏุงุฑูุฏ. ุชุนุงูู ุจู ูุตุงุญุจูโฺฏุฑ ู ูุตุงุญุจูโุดููุฏู ุจู ุฑูุดู ุดุฏู ููุน Rate Limiter ููุฑุฏ ูุธุฑ ฺฉูฺฉ ูโฺฉูุฏ.

---

#### ๐ฌ ูฺฉุงููู ููููู ุจู ฺฉุงูุฏุฏุง ู ูุตุงุญุจูโฺฏุฑ:

**ฺฉุงูุฏุฏุง:** ูุฑุงุฑ ุงุณุช ฺู ููุน ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ุทุฑุงุญ ฺฉููุ ุงุฒ ููุน ฺฉูุงูุช-ุณุงุฏ ุงุณุช ุง API ุณูุช ุณุฑูุฑุ

**ูุตุงุญุจูโฺฏุฑ:** ุณูุงู ุฎูุจ ุงุณุช. ุชูุฑฺฉุฒ ูุง ุฑู ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ุณูุช ุณุฑูุฑ (Server-side API Rate Limiter) ุงุณุช.

**ฺฉุงูุฏุฏุง:** ุขุง ุงู Rate Limiter ุจุงุฏ ุจุฑ ุงุณุงุณ IP ุง ุดูุงุณู ฺฉุงุฑุจุฑ (User ID) ุง ูฺฺฏโูุง ุฏฺฏุฑ ุฏุฑุฎูุงุณุชโูุง ุฑุง ูุญุฏูุฏ ฺฉูุฏุ

**ูุตุงุญุจูโฺฏุฑ:** ุงู ูุญุฏูุฏฺฉููุฏู ุจุงุฏ ุจู ุงูุฏุงุฒู ฺฉุงู ุงูุนุทุงูโูพุฐุฑ ุจุงุดุฏ ุชุง ุจุชูุงูุฏ ูุฌููุนูโุง ุงุฒ ููุงูู ูุฎุชูู ุฑุง ุจุฑุง ุงุนูุงู ูุญุฏูุฏุช ูพุดุชุจุงู ฺฉูุฏ.

**ฺฉุงูุฏุฏุง:** ููุงุณ ุณุณุชู ฺูุฏุฑ ุงุณุชุ ุจุฑุง ฺฉ ุงุณุชุงุฑุชุงูพ ฺฉูฺฺฉ ุงุณุช ุง ุจุฑุง ฺฉ ุดุฑฺฉุช ุจุฒุฑฺฏ ุจุง ฺฉุงุฑุจุฑุงู ุฒุงุฏุ

**ูุตุงุญุจูโฺฏุฑ:** ุณุณุชู ุจุงุฏ ุชูุงูุง ูพุงุณุฎฺฏู ุจู ุชุนุฏุงุฏ ุจุณุงุฑ ุฒุงุฏ ุงุฒ ุฏุฑุฎูุงุณุชโูุง ุฑุง ุฏุงุดุชู ุจุงุดุฏ.

**ฺฉุงูุฏุฏุง:** ุขุง ุงู ุณุณุชู ุจุงุฏ ุฏุฑ ฺฉ ูุญุท ุชูุฒุนโุดุฏู (Distributed Environment) ฺฉุงุฑ ฺฉูุฏุ

**ูุตุงุญุจูโฺฏุฑ:** ุจูู.

**ฺฉุงูุฏุฏุง:** ุขุง Rate Limiter ุจุงุฏ ุจู ุตูุฑุช ฺฉ ุณุฑูุณ ูุณุชูู ุทุฑุงุญ ุดูุฏ ุง ุฏุฑ ฺฉุฏ ุงูพูฺฉุดู ูุฑุงุฑ ฺฏุฑุฏุ

**ูุตุงุญุจูโฺฏุฑ:** ุงู ฺฉ ุชุตูู ุทุฑุงุญ ุงุณุช ฺฉู ุจุฑ ุนูุฏู ุดูุงุณุช.

**ฺฉุงูุฏุฏุง:** ุขุง ุจุงุฏ ฺฉุงุฑุจุฑุงู ูุญุฏูุฏุดุฏู (Throttled Users) ุฑุง ุงุฒ ูุถุนุชุดุงู ุขฺฏุงู ฺฉููุ

**ูุตุงุญุจูโฺฏุฑ:** ุจูู.

---

### ๐งพ ุฌูุนโุจูุฏ ูุงุฒููุฏโูุง (Requirements)

ุจุฑ ุงุณุงุณ ฺฏูุชโูฺฏููุง ุจุงูุงุ ูุงุฒููุฏโูุง ุทุฑุงุญ ุณุณุชู ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ุจู ุดุฑุญ ุฒุฑ ุงุณุช:

1. **ูุญุฏูุฏุณุงุฒ ุฏูู ุฏุฑุฎูุงุณุชโูุง ุจุดโุงุฒโุญุฏ:**
   ุณุณุชู ุจุงุฏ ุจุชูุงูุฏ ุจูโุฏุฑุณุช ุงุฒ ุฏุฑุฎูุงุณุชโูุง ุฎุงุฑุฌ ุงุฒ ุญุฏ ูุฌุงุฒ ุฌููฺฏุฑ ฺฉูุฏ.

2. **ุชุงุฎุฑ ูพุงู (Low Latency):**
   ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ูุจุงุฏ ุจุงุนุซ ุงูุฒุงุด ุฒูุงู ูพุงุณุฎ HTTP ุดูุฏ.

3. **ุญุฏุงูู ูุตุฑู ุญุงูุธู (Memory Efficient):**
   ุงุณุชูุงุฏู ุจููู ุงุฒ ุญุงูุธู ุฏุฑ ุทุฑุงุญ ุจุณุงุฑ ููู ุงุณุช.

4. **ูพุดุชุจุงู ุงุฒ ุชูุฒุนโูพุฐุฑ (Distributed Rate Limiting):**
   ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ุจุงุฏ ุจุชูุงูุฏ ุจูโุตูุฑุช ูุดุชุฑฺฉ ุจู ฺูุฏ ุณุฑูุฑ ุง ูุฑุขูุฏ ุงุฌุฑุง ุดูุฏ.

5. **ูุฏุฑุช ุงุณุชุซูุงูุง (Exception Handling):**
   ููฺฏุงู ุจููฺฉู ุดุฏู ุฏุฑุฎูุงุณุชโูุงุ ูพุงูโูุง ูุงุถุญ ุจู ฺฉุงุฑุจุฑุงู ููุงุด ุฏุงุฏู ุดูุฏ (ูุงููุฏ HTTP 429 Too Many Requests).

6. **ุชุญููโูพุฐุฑ ุจุงูุง ุฏุฑ ุจุฑุงุจุฑ ุฎุทุง (High Fault Tolerance):**
   ุงฺฏุฑ ูุดฺฉู ุฏุฑ ฺฉ ุงุฒ ุงุฌุฒุง Rate Limiter (ูุซูุงู ฺฉุด Redis) ูพุด ุขูุฏุ ูุจุงุฏ ฺฉู ุณุณุชู ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ฺฏุฑุฏ.

---

๐ **ูฺฉุชู ุชฺฉูู (ุงุถุงููโุดุฏู ุงุฒ ููุจุน ูุนุชุจุฑ):**
ุฏุฑ ุณุณุชูโูุง ุชูุฒุนโุดุฏูโุง ฺฉู ุจู ฺูุฏู ููุฏ Rate Limiting ูพุงุฏูโุณุงุฒ ูโุดูุฏุ ุงุณุชูุงุฏู ุงุฒ Redis ุง Memcached ุจุง TTL ู atomic counter ุจู ููุฑุงู fallback ูฺฉุงูุฒูโูุง ูุงููุฏ local in-memory cache ุชูุตู ูโุดูุฏ (ููุจุน: *Designing Data-Intensive Applications โ Martin Kleppmann*).

---
# ฺฏุงู ุฏูู โ ุทุฑุงุญ ุณุทุญ ุจุงูุง ู ุฌูุจ ูุธุฑ ูุตุงุญุจูโฺฏุฑ

ุจุฑุง ุณุงุฏู ูฺฏูโุฏุงุดุชู ุทุฑุญุ ุงุจุชุฏุง ฺฉ ูุฏู ุณุงุฏู ุงุฑุชุจุงุท ุจู **Client ู Server** ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑู. ุณูพุณุ ุจู ุงู ุณูุงู ฺฉูุฏ ูโูพุฑุฏุงุฒู:

---

### ๐ ฺฉุฌุง ุจุงุฏ Rate Limiter ูพุงุฏูโุณุงุฒ ุดูุฏุ

ุฏุฑ ูฺฏุงู ุงููุ Rate Limiter ุฑุง ูโุชูุงู ุฏุฑ ฺฉ ุงุฒ ุฏู ุฌุงฺฏุงู ุฒุฑ ูพุงุฏูโุณุงุฒ ฺฉุฑุฏ:

#### ฑ. ูพุงุฏูโุณุงุฒ ุฏุฑ ุณูุช ฺฉูุงูุช (Client-side)

* ุจู ุทูุฑ ฺฉูุ **ุณูุช ฺฉูุงูุช ูฺฉุงู ูุงุจู ุงุนุชูุงุฏ ุจุฑุง ุงุฌุฑุง ูุญุฏูุฏฺฉููุฏู ูุฑุฎ ูุณุช**ุ ุฒุฑุง:

  * ุฏุฑุฎูุงุณุชโูุง ุงุฒ ุณูุช ฺฉูุงูุช ุจูโุฑุงุญุช ูโุชูุงููุฏ ุชูุณุท ฺฉุงุฑุจุฑุงู ูุฎุฑุจ (malicious users) ุฌุนู ุดููุฏ.
  * ููฺฉู ุงุณุช ฺฉูุชุฑู ฺฉุงูู ุจุฑ ูพุงุฏูโุณุงุฒ ฺฉูุงูุช ูุฏุงุดุชู ุจุงุดู (ูุงููุฏ ุงูพโูุง ุดุฎุต ุซุงูุซ).

#### ฒ. ูพุงุฏูโุณุงุฒ ุฏุฑ ุณูุช ุณุฑูุฑ (Server-side)

* ุฏุฑ ุงู ุญุงูุชุ Rate Limiter ุฏุฑ ูุณุฑ ุฑุณุฏู ุฏุฑุฎูุงุณุช ุจู API ุณุฑูุฑ ูุฑุงุฑ ูโฺฏุฑุฏ.

![](./Pictures/4-1.png)

#### ณ. ุฑุงูฺฉุงุฑ ุฌุงฺฏุฒู: ูพุงุฏูโุณุงุฒ ุจูโุนููุงู Middleware

* ุจูโุฌุง ูพุงุฏูโุณุงุฒ ูุณุชูู ุฏุฑ ุณุฑูุฑูุง APIุ ูโุชูุงู ุงุฒ ฺฉ **Middleware** ุจุฑุง ฺฉูุชุฑู ูุฑุฎ ุฏุฑุฎูุงุณุชโูุง ุงุณุชูุงุฏู ฺฉุฑุฏ.
* ุงู ูุนูุงุฑ ุจู ุดฺฉู ุฒุฑ ุนูู ูโฺฉูุฏ:

  * ฺฉูุงูุชโูุง ุฏุฑุฎูุงุณุช ุฎูุฏ ุฑุง ุจู Middleware ุงุฑุณุงู ูโฺฉููุฏ.
  * Middleware ููุด ูุงุณุท ุฑุง ุงูุง ฺฉุฑุฏู ู ูุจู ุงุฒ ุฑุณุฏู ุฏุฑุฎูุงุณุช ุจู ุณุฑูุฑ APIุ ุขู ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ.
  * ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุงุฒ ุญุฏ ูุฌุงุฒ ุนุจูุฑ ฺฉุฑุฏู ุจุงุดุฏุ ูพุงุณุฎ `HTTP 429 Too Many Requests` ุจุงุฒูโฺฏุฑุฏุฏ.


![](./Pictures/4-2.png)

---

### ๐ฏ ูุซุงู ุนููฺฉุฑุฏ ุงุฒ ูุญุฏูุฏฺฉููุฏู ูุฑุฎ

ุจุฑุง ุฏุฑฺฉ ุจูุชุฑุ ุจู ูุซุงู ุงุฒ **ูููุฏุงุฑ Figure 4-3** ุชูุฌู ฺฉูุฏ:

ูุฑุถ ฺฉูู ุฏุฑ ุทุฑุงุญ ูุงุ ูุฑ ฺฉุงุฑุจุฑ ููุท **ฒ ุฏุฑุฎูุงุณุช ุฏุฑ ุซุงูู** ูุฌุงุฒ ุงุณุช. ุญุงูุ ฺฉูุงูุช ุฏุฑ ุนุฑุถ ฺฉ ุซุงูู **ณ ุฏุฑุฎูุงุณุช** ุงุฑุณุงู ูโฺฉูุฏ:

* ุฏู ุฏุฑุฎูุงุณุช ุงูู ุชูุณุท Middleware ูุฌุงุฒ ุฏุงูุณุชู ุดุฏู ู ุจู API Server ุงุฑุณุงู ูโุดููุฏ.
* ุฏุฑุฎูุงุณุช ุณูู ุจู ุฏูู ููุถ ูุญุฏูุฏุชุ ุชูุณุท Middleware ุฑุฏ ุดุฏู ู ฺฉุฏ HTTP 429 ุจู ฺฉุงุฑุจุฑ ุจุงุฒฺฏุฑุฏุงูุฏู ูโุดูุฏ.


![](./Pictures/4-3.png)
---

### ๐ก ูุนูุงุฑโูุง ูุงูุน: Rate Limiting ุฏุฑ API Gateway

ุฏุฑ ูุนูุงุฑโูุง ูุฏุฑู ูุจุชู ุจุฑ **microservice**ุ ุงุณุชูุงุฏู ุงุฒ **API Gateway** ุจูโุดุฏุช ุฑุงุฌ ุงุณุช. ุงู Gateway ูุนูููุงู ูุงุจูุชโูุง ุฒุฑ ุฑุง ูุฑุงูู ูโฺฉูุฏ:

* Rate Limiting
* SSL Termination
* Authentication
* IP Whitelisting
* ุณุฑูุณโุฏู ุจู ูุญุชูุง ุงุณุชุง (Static Content)

ุจูโุนููุงู ูููููุ ูโุชูุงู ุจู ุณุฑูุณโูุง ุฒุฑ ุงุดุงุฑู ฺฉุฑุฏ ฺฉู ุจูโุตูุฑุช ูุฏุฑุชโุดุฏู API Gateway ุงุฑุงุฆู ูโุฏููุฏ:

* **AWS API Gateway**
* **Kong API Gateway**
* **NGINX Gateway with Lua scripting**
* **Google Cloud Endpoints**

๐ *(ููุจุน: \[4] Cloud Microservices Architecture, Martin Fowler โ martinfowler.com)*

---

### โ๏ธ ุชุตููโฺฏุฑ ุฏุฑ ููุฑุฏ ูุญู ูพุงุฏูโุณุงุฒ Rate Limiter

ูฺ ูพุงุณุฎ ูุทุน ุจุฑุง ูุญู ูพุงุฏูโุณุงุฒ Rate Limiter ูุฌูุฏ ูุฏุงุฑุฏ. ุงูุง ูฺฉุงุช ุฒุฑ ุฑุงูููุง ุฎูุจ ูุณุชูุฏ:

| ูฺฉุชู ุทุฑุงุญ                    | ุชูุถุญ                                                                                                                          |
| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| **ุชฺฉููููฺ ููุฌูุฏ**            | ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุฒุจุงู ุจุฑูุงููโููุณ ู ฺฉุด ูุนู ูพุฑูฺู ุจุฑุง ูพุงุฏูโุณุงุฒ Rate Limiter ููุงุณุจ ุจุงุดุฏ (ูุซูุงู Redis + Python ุง Golang).      |
| **ุงูุนุทุงู ุฏุฑ ุงูุชุฎุงุจ ุงูฺฏูุฑุชู** | ุงฺฏุฑ ุงุฒ Gatewayูุง ุดุฎุต ุซุงูุซ ุงุณุชูุงุฏู ูโฺฉูุฏุ ููฺฉู ุงุณุช ููุท ุจุฑุฎ ุงูฺฏูุฑุชูโูุง ูุงุจู ุชูุธู ุจุงุดูุฏ. ูู ุฏุฑ ุณูุช ุณุฑูุฑุ ฺฉูุชุฑู ฺฉุงูู ุฏุงุฑุฏ. |
| **ูุนูุงุฑ ูุนู**               | ุงฺฏุฑ ูุนูุงุฑ ุดูุง ููโุงฺฉููู API Gateway ุฏุงุฑุฏุ ูโุชูุงูุฏ ุจูโุฑุงุญุช Rate Limiting ุฑุง ุจู ุขู ุงุถุงูู ฺฉูุฏ.                                |
| **ููุงุจุน ูููุฏุณ**              | ูพุงุฏูโุณุงุฒ Rate Limiter ุณูุงุฑุด ูุงุฒ ุจู ุฒูุงู ู ูุฑู ุฏุงุฑุฏ. ุฏุฑ ูุจูุฏ ููุงุจุน ฺฉุงูุ ุงุณุชูุงุฏู ุงุฒ API Gateway ุขูุงุฏู ุชูุตู ูโุดูุฏ.        |

---

# ุงูฺฏูุฑุชูโูุง ูุญุฏูุฏุณุงุฒ ูุฑุฎ (Rate Limiting Algorithms)

ุจุฑุง ูพุงุฏูโุณุงุฒ Rate Limiting ูโุชูุงู ุงุฒ ุงูฺฏูุฑุชูโูุง ูุฎุชูู ุงุณุชูุงุฏู ฺฉุฑุฏ ฺฉู ูุฑ ฺฉ **ูุฒุงุง ู ูุนุงุจ ุฎุงุต ุฎูุฏ** ุฑุง ุฏุงุฑูุฏ. ุงฺฏุฑฺู ุชูุฑฺฉุฒ ุงู ูุตู ุจุฑ ุฑู ุฌุฒุฆุงุช ุงูฺฏูุฑุชูโูุง ูุณุชุ ุงูุง ุฏุฑฺฉ ููุงูู ุณุทุญ ุจุงูุง ุขูโูุง ุจู ูุง ฺฉูฺฉ ูโฺฉูุฏ ุชุง ุจุณุชู ุจู **ููุงุฑุฏ ฺฉุงุฑุจุฑุฏ (use case)** ููุงุณุจโุชุฑู ุงูฺฏูุฑุชู ุง ุชุฑฺฉุจ ุงุฒ ุขูโูุง ุฑุง ุงูุชุฎุงุจ ฺฉูู.

---

### โ ููุฑุณุช ุงูฺฏูุฑุชูโูุง ุฑุงุฌ:

---

#### 1. **Token Bucket (ุณุทู ุชูฺฉู)**

* **ููููู**: ฺฉ ุณุทู ุญุงู ุชูฺฉูโูุง ุฏุงุฑู ฺฉู ุจุง ุณุฑุนุช ุซุงุจุช ูพุฑ ูโุดูุฏ. ูุฑ ุจุงุฑ ฺฉู ฺฉ ุฏุฑุฎูุงุณุช ูโุฑุณุฏุ ฺฉ ุชูฺฉู ูุตุฑู ูโุดูุฏ. ุงฺฏุฑ ุชูฺฉู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ุฏุฑุฎูุงุณุช ุฑุฏ ูโุดูุฏ.
* **ูุฒุงุง**:

  * ูพุดุชุจุงู ุงุฒ ุงููุฌุงุฑูุง ฺฉูุชุงู (burst)
  * ฺฉูุชุฑู ูุฑุฎ ูุชูุณุท ู ุงุฌุงุฒู ุจู ุฏุฑุฎูุงุณุชโูุง ูุงฺฏูุงู ุฏุฑ ุจุงุฒู ฺฉูุชุงู
* **ฺฉุงุฑุจุฑุฏ ุฑุงุฌ**: ููุงุณุจ ุจุฑุง APIูุง ฺฉู ุงูฺฉุงู ุงูุฒุงุด ูุงฺฏูุงู ุชุฑุงูฺฉ ุฏุงุฑูุฏ.
* ๐ *ููุจุน: RFC 2697 (A Single Rate Three Color Marker)*

---

#### 2. **Leaky Bucket (ุณุทู ฺฺฉูโุง)**

* **ููููู**: ูุดุงุจู ุณุทู ุขุจ ุงุณุช ฺฉู ุจุง ูุฑุฎ ุซุงุจุช ูุดุช ูโฺฉูุฏ. ุงฺฏุฑ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุจุด ุงุฒ ุธุฑูุช ุณุทู ุจุงุดุฏุ ุฏุฑุฎูุงุณุชโูุง ุงุถุงู ุญุฐู ูโุดููุฏ.
* **ูุฒุงุง**:

  * ฺฉููุงุฎุชโุณุงุฒ ุจุงุฑ ุชุฑุงูฺฉ (smoothing traffic)
  * ุฌููฺฏุฑ ุงุฒ ุงููุฌุงุฑูุง ูุงฺฏูุงู
* **ูุนุงุจ**:

  * ุจู ุงูุฏุงุฒู Token Bucket ุงูุนุทุงูโูพุฐุฑ ูุณุช.
* **ฺฉุงุฑุจุฑุฏ ุฑุงุฌ**: ฺฉูุชุฑู ุชุฑุงูฺฉ ุฏุฑ ุณุณุชูโูุง ุจุงูฺฉ ุง ุซุจุช ูุงฺฏ ูพุงุฏุงุฑ.

---

#### 3. **Fixed Window Counter (ุดูุงุฑูุฏู ุจุง ูพูุฌุฑู ุฒูุงู ุซุงุจุช)**

* **ููููู**: ุฏุฑุฎูุงุณุชโูุง ุฏุฑ ุจุงุฒูโูุง ุฒูุงู ุซุงุจุช (ูุซูุงู ูุฑ ุฏููู) ุดูุงุฑุด ูโุดููุฏ. ุงฺฏุฑ ุชุนุฏุงุฏ ุขูโูุง ุงุฒ ุขุณุชุงูู ุจุดุชุฑ ุดูุฏุ ุฑุฏ ูโุดููุฏ.
* **ูุฒุงุง**:

  * ูพุงุฏูโุณุงุฒ ุณุงุฏู
* **ูุนุงุจ**:

  * ุงูฺฉุงู ุญููู ุงููุฌุงุฑ ุฏุฑ ูุฑุฒ ูพูุฌุฑูโูุง (Request Burst at boundary)
* **ฺฉุงุฑุจุฑุฏ ุฑุงุฌ**: ููุงุณุจ ุจุฑุง ูุญุฏูุฏุชโูุง ุณุงุฏู ุจุฑ ุงุณุงุณ IP ุง User ID.

---

#### 4. **Sliding Window Log (ูุงฺฏ ุจุง ูพูุฌุฑู ูุบุฒุงู)**

* **ููููู**: ุฒูุงู ูุฑ ุฏุฑุฎูุงุณุช ุฏุฑ ฺฉ ูุณุช ุฐุฎุฑู ูโุดูุฏ ู ุฏุฑ ูุฑ ุจุงุฑ ุจุฑุฑุณุ ุฏุฑุฎูุงุณุชโูุง ฺฉู ุฏุฑ ุจุงุฒู ูุบุฒุงู (ูุซูุงู 60 ุซุงูู ุงุฎุฑ) ูุณุชูุฏ ุดูุงุฑุด ูโุดููุฏ.
* **ูุฒุงุง**:

  * ุฏูุช ุจุงูุง
* **ูุนุงุจ**:

  * ูุตุฑู ุจุงูุง ุญุงูุธู (ุฐุฎุฑูโุณุงุฒ timestamps)
* **ฺฉุงุฑุจุฑุฏ ุฑุงุฌ**: ุณุณุชูโูุง ุจุง ูุงุฒ ุจู ฺฉูุชุฑู ุฏูู ูุฑุฎ ุจุฑ ุงุณุงุณ ุฒูุงู.

---

#### 5. **Sliding Window Counter (ุดูุงุฑูุฏู ุจุง ูพูุฌุฑู ูุบุฒุงู)**

* **ููููู**: ุดุจู ุจู Fixed Windowุ ูู ุฏู ูพูุฌุฑู ุฒูุงู ูุฌุงูุฑ ุฑุง ุฏุฑ ูุธุฑ ูโฺฏุฑุฏ ู ุจุฑ ุงุณุงุณ ูุงูฺฏู ูุฒูโุฏุงุฑุ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุฑุง ูโุณูุฌุฏ.
* **ูุฒุงุง**:

  * ุฏูุช ุจุดุชุฑ ูุณุจุช ุจู Fixed Window
  * ูุตุฑู ุญุงูุธู ฺฉูุชุฑ ุงุฒ Sliding Log
* **ฺฉุงุฑุจุฑุฏ ุฑุงุฌ**: ุณุณุชูโูุง ุจุง ูุงุฒ ุจู ุชุนุงุฏู ุจู ุฏูุช ู ุนููฺฉุฑุฏ.

---

### ๐ฏ ูุชุฌูโฺฏุฑ ู ุงูุชุฎุงุจ ููุงุณุจ

| ุงูฺฏูุฑุชู        | ุฏูุช           | ูุตุฑู ุญุงูุธู | ูพุดุชุจุงู ุงุฒ Burst | ููุงุณุจ ุจุฑุง                 |
| --------------- | ------------- | ---------- | ----------------- | -------------------------- |
| Token Bucket    | ูุชูุณุท         | ฺฉู         | ุจูู               | APIูุง ุนููู               |
| Leaky Bucket    | ูุชูุณุท         | ฺฉู         | ุฎุฑ               | ูพุฑุฏุงุฒุด ูพุงุฏุงุฑ              |
| Fixed Window    | ูพุงู         | ุจุณุงุฑ ฺฉู   | ุฎุฑ               | ููุงุฑุฏ ุณุงุฏู                 |
| Sliding Log     | ุจุงูุง          | ุจุงูุง       | ุจูู               | ุงููุช ู ฺฉูุชุฑู ุฏูู         |
| Sliding Counter | ูุชูุณุท ุจู ุจุงูุง | ูุชูุณุท      | ุจูู               | ุงุณุชูุงุฏู ุนููู ุจุง ุฏูุช ูุชูุณุท |

---

๐ ููุงุจุน:

* [Rate Limiting Algorithms โ Cloudflare Blog](https://blog.cloudflare.com/rate-limiting-algorithms/)
* [High Scalability โ Design Patterns for Rate Limiting](http://highscalability.com/blog/2016/4/20/design-patterns-for-rate-limiting.html)
* [AWS Rate Limiting Techniques โ AWS Architecture Blog](https://aws.amazon.com/architecture)

---
### ุงูฺฏูุฑุชู Token Bucket (ุณุทู ุชูฺฉู)

![](./Pictures/The-Token-Bucket-Algorithm.png)



ุงูฺฏูุฑุชู **Token Bucket** ฺฉ ุงุฒ ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ู ุณุงุฏูโุชุฑู ุงูฺฏูุฑุชูโูุง ุจุฑุง ูพุงุฏูโุณุงุฒ **Rate Limiting** ุงุณุช. ุงู ุงูฺฏูุฑุชู ุจูโุทูุฑ ฺฏุณุชุฑุฏู ุฏุฑ ุดุฑฺฉุชโูุง ุจุฒุฑฺฏ ุงูุชุฑูุช ุงุณุชูุงุฏู ูโุดูุฏ. ุจู ุนููุงู ูุซุงูุ ุดุฑฺฉุชโูุง **Amazon** \[ููุจุน: Amazon API Gateway Throttling \[5]] ู **Stripe** \[ููุจุน: Stripe API Rate Limits \[6]] ุงุฒ ุงู ุงูฺฏูุฑุชู ุจุฑุง ฺฉูุชุฑู ูุฑุฎ ุฏุฑุฎูุงุณุชโูุง API ุฎูุฏ ุงุณุชูุงุฏู ูโฺฉููุฏ.

---

## ๐ ูุญูู ฺฉุงุฑ ุงูฺฏูุฑุชู Token Bucket:

* ฺฉ **ุณุทู ุชูฺฉู (Token Bucket)**ุ ุฏุฑ ูุงูุน ฺฉ ุธุฑู ุจุง ุธุฑูุช ุงุฒ ูพุด ุชุนูโุดุฏู ุงุณุช.
* ุงู ุณุทู ุจูโุตูุฑุช **ุฏูุฑูโุง (periodically)** ุจุง **ุชูฺฉูโูุง** ฺฉู ููุงูุฏู ูุฌูุฒ ุงุฑุณุงู ุฏุฑุฎูุงุณุช ูุณุชูุฏุ **ูพุฑ ูโุดูุฏ**.
* ุงฺฏุฑ ุณุทู ูพุฑ ุดูุฏุ ุชูฺฉูโูุง ุงุถุงู **ุฏูุฑ ุฑุฎุชู ูโุดููุฏ (overflow)** ู ูุงุฑุฏ ุณุทู ููโุดููุฏ.
![](./Pictures/4-4.png)
* ูุฑ ุฏุฑุฎูุงุณุช HTTPุ **ฺฉ ุชูฺฉู ูุตุฑู ูโฺฉูุฏ**.
* ุงฺฏุฑ **ุชูฺฉู ฺฉุงู** ุฏุฑ ุณุทู ุจุงุดุฏุ ุชูฺฉู ฺฉู ุดุฏู ู ุฏุฑุฎูุงุณุช **ุงุฌุงุฒู ุนุจูุฑ ูพุฏุง ูโฺฉูุฏ**.
* ุงฺฏุฑ **ุชูฺฉู ฺฉุงู ูุจุงุดุฏ**ุ ุฏุฑุฎูุงุณุช **ุฑุฏ ูโุดูุฏ** (Throttle/Drop).

![](./Pictures/4-5.png)
---

### ๐ข ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ุงูฺฏูุฑุชู:

1. **Bucket Size (ุธุฑูุช ุณุทู)**
   ุจุดุชุฑู ุชุนุฏุงุฏ ุชูฺฉู ฺฉู ูโุชูุงูุฏ ุฏุฑ ุณุทู ูฺฏูุฏุงุฑ ุดูุฏ.

2. **Refill Rate (ูุฑุฎ ูพุฑุดุฏู)**
   ูุฑุฎ ฺฉู ุฏุฑ ุขู ุชูฺฉูโูุง ุจูโุตูุฑุช ุซุงุจุช ูุงุฑุฏ ุณุทู ูโุดููุฏุ ูุซูุงู 4 ุชูฺฉู ุฏุฑ ูุฑ ุฏููู.

---

### ๐ฏ ูุซุงู ุงุฒ ุนููฺฉุฑุฏ:

ูุฑุถ ฺฉูู:

* ุธุฑูุช ุณุทู = 4 ุชูฺฉู
* ูุฑุฎ ูพุฑ ุดุฏู = 2 ุชูฺฉู ุฏุฑ ูุฑ ุซุงูู

ุฏุฑ ุงู ุตูุฑุชุ ูุฑ ุซุงูู ุฏู ุชูฺฉู ุจู ุณุทู ุงุถุงูู ูโุดูุฏ ุชุง ุฒูุงู ฺฉู ุณุทู ุจู ุธุฑูุช ด ุจุฑุณุฏ. ุญุงู ุงฺฏุฑ ุฏุฑ ฺฉ ุซุงูู 3 ุฏุฑุฎูุงุณุช ุจุฑุณุฏ:

* 2 ุฏุฑุฎูุงุณุช ุงูู ุชูฺฉู ุฏุฑุงูุช ูโฺฉููุฏ ู ุนุจูุฑ ูโฺฉููุฏ.
* ุฏุฑุฎูุงุณุช ุณูู ฺูู ุชูฺฉู ูุณุชุ **ุฑุฏ ุฎูุงูุฏ ุดุฏ (HTTP 429)**.

![](./Pictures/4-6.png)

---

### ๐งฎ ูุญุงุณุจู ุชุนุฏุงุฏ ุณุทูโูุง ููุฑุฏ ูุงุฒ:

ุชุนุฏุงุฏ ุณุทูโูุง ุจุณุชฺฏ ุจู **ุณุงุณุชโูุง ูุญุฏูุฏุณุงุฒ ูุฑุฎ** ุฏุงุฑุฏ:

* ุงฺฏุฑ ุจุฑุง ูุฑ endpoint ูุฑุฎ ุฌุฏุงฺฏุงูู ุชุนุฑู ุดุฏู ุจุงุดุฏุ ุจุฑุง ูุฑ **user ู endpoint** ุจุงุฏ **ฺฉ ุณุทู ูุฌุฒุง** ุฏุงุดุชู ุจุงุดู.
  ูุซุงู:

  * ูพุณุช ฺฏุฐุงุดุชู: 1 ุจุงุฑ ุฏุฑ ุซุงูู
  * ุงูุฒูุฏู ุฏูุณุช: 150 ุจุงุฑ ุฏุฑ ุฑูุฒ
  * ูุงฺฉ ฺฉุฑุฏู: 5 ุจุงุฑ ุฏุฑ ุซุงูู
    ูุชุฌู โ ณ ุณุทู ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ

* ุงฺฏุฑ ูุญุฏูุฏุณุงุฒ ุจุฑ ุงุณุงุณ IP ุจุงุดุฏุ ุจุฑุง **ูุฑ ุขุฏุฑุณ IP ฺฉ ุณุทู** ูุงุฒู ุงุณุช.

* ุงฺฏุฑ ฺฉ ุณูู ฺฉู ุจุฑุง ฺฉู ุณุณุชู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดูุฏ (ูุซูุงู 10,000 ุฏุฑุฎูุงุณุช ุฏุฑ ุซุงูู)ุ ฺฉ **ุณุทู ุฌูุงู (global bucket)** ูุดุชุฑฺฉ ุจู ููู ฺฉุงุฑุจุฑุงู ฺฉุงู ุงุณุช.

---

### โ ูุฒุงุง (Pros):

* **ูพุงุฏูโุณุงุฒ ุณุงุฏู**
* **ูุตุฑู ฺฉู ุญุงูุธู**
* **ูพุดุชุจุงู ุงุฒ ุชุฑุงูฺฉ ุงููุฌุงุฑ (Burst Traffic)** ุจุฑุง ูุฏุช ฺฉูุชุงู
  (ุชุง ููุช ุชูฺฉู ุจุงุดุฏุ ุฏุฑุฎูุงุณุช ูุฌุงุฒ ุงุณุช ุญุช ุงฺฏุฑ ูุฑุงุชุฑ ุงุฒ ูุฑุฎ ูุญุธูโุง ุจุงุดุฏ.)

---

### โ ูุนุงุจ (Cons):

* ูุงุฒ ุจู **ุชูุธู ุจููู ุฏู ูพุงุฑุงูุชุฑ**:

  * ุธุฑูุช ุณุทู (bucket size)
  * ูุฑุฎ ูพุฑ ุดุฏู (refill rate)

  ุงฺฏุฑ ุงู ููุงุฏุฑ ุจูโุฏุฑุณุช ุชูุธู ูุดููุฏุ ุง ุจุดโุงุฒุญุฏ ุณุฎุชฺฏุฑุงูู ูโุดููุฏ ุง ุจุดโุงุฒุญุฏ ฺฏุดุงุฏูโุฏุณุชุ ฺฉู ูุฑ ุฏู ูโุชูุงููุฏ ุชุฌุฑุจู ฺฉุงุฑุจุฑ ุฑุง ุชุญุช ุชุฃุซุฑ ูุฑุงุฑ ุฏููุฏ.

---

๐ **ููุงุจุน:**

* \[5] Amazon API Gateway โ Throttle API Requests: [https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-request-throttling.html](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-request-throttling.html)
* \[6] Stripe API Rate Limiting: [https://stripe.com/docs/rate-limits](https://stripe.com/docs/rate-limits)
* [Designing a Scalable Rate Limiter โ High Scalability Blog](http://highscalability.com/blog/2016/4/20/design-patterns-for-rate-limiting.html)
* [Google API Quotas](https://developers.google.com/docs/api/limits)

---

๐ **ูฺฉุชู ุชฺฉูู**: ุฏุฑ ููุงุณู ุจุง ุณุงุฑ ุงูฺฏูุฑุชูโูุงุ Token Bucket ุจุดุชุฑ ุจุฑุง ฺฉุงุฑุจุฑุฏูุง ููุงุณุจ ุงุณุช ฺฉู **ุชุฑุงูฺฉ ูุงฺฏูุงู ู ุงููุฌุงุฑ** ุฏุงุดุชู ู ูุงุฒ ุจู ฺฉูุชุฑู ุขู ูุฌูุฏ ุฏุงุฑุฏ ูู ุฏุฑ ุนู ุญุงู ูุจุงุฏ ูุงูุน ุงุฒ ุงุฑุณุงู ุฏุฑุฎูุงุณุชโูุง ููุทู ู ูุฌุงุฒ ุดูุฏ.

## ุงูฺฏูุฑุชู Leaking Bucket (ุณุทู ูุดุชโูพุฐุฑ)

ุงูฺฏูุฑุชู **Leaking Bucket** (ุณุทู ูุดุชโูพุฐุฑ) ุงุฒ ูุธุฑ ููููู ุดุจู ุจู ุงูฺฏูุฑุชู **Token Bucket** ุงุณุชุ ุจุง ุงู ุชูุงูุช ฺฉู ุฏุฑ ุงู ุงูฺฏูุฑุชู **ูพุฑุฏุงุฒุด ุฏุฑุฎูุงุณุชโูุง ุจุง ูุฑุฎ ุซุงุจุช ุงูุฌุงู ูโุดูุฏ**. ุงู ูฺฺฏ ุจุงุนุซ ูโุดูุฏ ฺฉู Leaking Bucket ุจุฑุง ุณูุงุฑููุง ฺฉู **ุฎุฑูุฌ ฺฉููุงุฎุช ู ูพุงุฏุงุฑ (Stable Outflow Rate)** ูุงุฒ ุฏุงุฑูุฏุ ุจุณุงุฑ ููุงุณุจ ุจุงุดุฏ.

---

### ๐ ูุญูู ุนููฺฉุฑุฏ ุงูฺฏูุฑุชู Leaking Bucket:

* ุงู ุงูฺฏูุฑุชู ูุนูููุงู ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉ **ุตู ุจู ุตูุฑุช FIFO (First-In-First-Out)** ูพุงุฏูโุณุงุฒ ูโุดูุฏ.
* ุฒูุงู ฺฉู ฺฉ ุฏุฑุฎูุงุณุช ูุงุฑุฏ ุณุณุชู ูโุดูุฏ:

  * ุงฺฏุฑ **ุตู ูพุฑ ูุจุงุดุฏ**ุ ุฏุฑุฎูุงุณุช ุจู **ุตู ุงูุฒูุฏู ูโุดูุฏ**.
  * ุงฺฏุฑ **ุตู ูพุฑ ุจุงุดุฏ**ุ ุฏุฑุฎูุงุณุช **ุฑุฏ (drop)** ูโุดูุฏ.
* ุฏุฑุฎูุงุณุชโูุง ุงุฒ ุตู ุจุง ฺฉ **ูุฑุฎ ุฎุฑูุฌ ุซุงุจุช (Outflow Rate)** ูพุฑุฏุงุฒุด ูโุดููุฏ.

![](./Pictures/4-7.png)
---

### ๐ข ูพุงุฑุงูุชุฑูุง ฺฉูุฏ ุงูฺฏูุฑุชู:

1. **Bucket Size (ุธุฑูุช ุณุทู)**
   ููุงู ุงูุฏุงุฒู ุตู ุงุณุช ู ูุดุฎุต ูโฺฉูุฏ ฺูุฏ ุฏุฑุฎูุงุณุช ุฏุฑ ุงูุชุธุงุฑ ูพุฑุฏุงุฒุด ูโุชูุงููุฏ ุจุงุดูุฏ.

2. **Outflow Rate (ูุฑุฎ ุฎุฑูุฌ)**
   ุชุนู ูโฺฉูุฏ ฺูุฏ ุฏุฑุฎูุงุณุช ุฏุฑ ฺฉ ุจุงุฒู ุฒูุงู ูุดุฎุต (ูุซูุงู ุฏุฑ ูุฑ ุซุงูู) ูโุชูุงููุฏ ุงุฒ ุตู ุฎุงุฑุฌ ู ูพุฑุฏุงุฒุด ุดููุฏ.

---

### ๐ ูุซุงู ูุงูุน:

ุดุฑฺฉุช ุชุฌุงุฑุช ุงูฺฉุชุฑููฺฉ **Shopify** ุงุฒ ุงูฺฏูุฑุชู **Leaking Bucket** ุจุฑุง ูพุงุฏูโุณุงุฒ **Rate Limiting** ุฏุฑ ุฒุฑุณุงุฎุชโูุง ุฎูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ.
๐ ููุจุน: \[7] Shopify Rate Limits โ [https://shopify.dev/docs/api/usage/rate-limits](https://shopify.dev/docs/api/usage/rate-limits)

---

### โ ูุฒุงุง (Pros):

* **ุงุณุชูุงุฏู ุจููู ุงุฒ ุญุงูุธู** ุจูโุฏูู ุตู ุจุง ุงูุฏุงุฒู ูุญุฏูุฏ.
* **ูพุฑุฏุงุฒุด ูพุงุฏุงุฑ** ู ฺฉููุงุฎุช ุฏุฑุฎูุงุณุชโูุงุ ููุงุณุจ ุจุฑุง ุณุณุชูโูุง ฺฉู ูุงุฒ ุจู **ุฎุฑูุฌ ุจุง ูุฑุฎ ูุดุฎุต** ุฏุงุฑูุฏุ ูุซู ูพุฑุฏุงุฒุด ุชุฑุงฺฉูุดโูุง ูุงู ุง ูุงฺฏ ุณุฑูุฑูุง.

---

### โ ูุนุงุจ (Cons):

* ุฏุฑ ุดุฑุงุท **ุชุฑุงูฺฉ ุงููุฌุงุฑ (Burst Traffic)**ุ ุตู ุณุฑุน ูพุฑ ูโุดูุฏ ู ุฏุฑุฎูุงุณุชโูุง ูุฏู ุฏุฑ ุตู ุจุงู ูโูุงููุฏุ ุฏุฑ ูุชุฌูุ **ุฏุฑุฎูุงุณุชโูุง ุฌุฏุฏุชุฑ ูุฒ ุฑุฏ ูโุดููุฏ** ุญุช ุงฺฏุฑ ููุทูโุชุฑ ุจุงุดูุฏ.
* ูุงููุฏ ุงูฺฏูุฑุชู Token Bucketุ **ุชูุธู ุฏูู ุฏู ูพุงุฑุงูุชุฑ ุงุตู** (ุงูุฏุงุฒู ุณุทู ู ูุฑุฎ ุฎุฑูุฌ) ููฺฉู ุงุณุช ฺุงูุดโุจุฑุงูฺฏุฒ ุจุงุดุฏ.

---

### ๐ ูฺฉุชู ุชฺฉูู:

ุงูฺฏูุฑุชู Leaking Bucket ุจุฑุฎูุงู Token Bucket **ุงุฌุงุฒู ุชุฑุงูฺฉ ุงููุฌุงุฑ (burst)** ุฑุง ููโุฏูุฏ ู ูููุงุฑู ุชูุงุด ูโฺฉูุฏ **ุฎุฑูุฌ ฺฉููุงุฎุช** ุฏุงุดุชู ุจุงุดุฏ. ุจูุงุจุฑุงูุ ุงฺฏุฑ ุณุณุชู ุฏุงุฑุฏ ฺฉู ุธุฑูุช ูุญุฏูุฏ ุจุฑุง ูพุฑุฏุงุฒุด ููโุฒูุงู ุฏุงุฑุฏุ ุงุณุชูุงุฏู ุงุฒ Leaky Bucket ุงูุชุฎุงุจ ุจูุชุฑ ูุณุจุช ุจู Token Bucket ุฎูุงูุฏ ุจูุฏ.

---

๐ ููุงุจุน:

* \[7] Shopify API Rate Limits: [https://shopify.dev/docs/api/usage/rate-limits](https://shopify.dev/docs/api/usage/rate-limits)
* [Designing Scalable Rate Limiting โ Cloudflare Engineering Blog](https://blog.cloudflare.com/counting-things-a-lot-of-different-things/)
* [Rate Limiting Algorithms โ Stripe Docs](https://stripe.com/docs/rate-limits)

---

๐ ููุงุณู ุณุฑุน:

| ูฺฺฏ              | Token Bucket      | Leaking Bucket             |
| ------------------ | ----------------- | -------------------------- |
| ูพุดุชุจุงู ุงุฒ Burst  | ุฏุงุฑุฏ โ            | ูุฏุงุฑุฏ โ                    |
| ูุฑุฎ ุฎุฑูุฌ          | ุงูุนุทุงูโูพุฐุฑ       | ุซุงุจุช                       |
| ูพฺุฏฺฏ ูพุงุฏูโุณุงุฒ | ูพุงู             | ูุชูุณุท                      |
| ููุงุณุจ ุจุฑุง         | API ุจุง ุงูุนุทุงู ูุฑุฎ | ูพุฑุฏุงุฒุดโูุง ูุญุฏูุฏ ู ฺฉููุงุฎุช |

---
## ุงูฺฏูุฑุชู Fixed Window Counter (ุดูุงุฑูุฏูโ ูพูุฌุฑูโ ุซุงุจุช)

ุงูฺฏูุฑุชู **Fixed Window Counter** ฺฉ ุงุฒ ุณุงุฏูโุชุฑู ุฑูุดโูุง ูพุงุฏูโุณุงุฒ **Rate Limiting** ุงุณุช ฺฉู ุงุฒ ุทุฑู ุชูุณู ุจุงุฒู ุฒูุงู ุจู **ูพูุฌุฑูโูุง ุฒูุงู ุซุงุจุช** ู ุดูุงุฑุด ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ุฏุฑ ูุฑ ูพูุฌุฑูุ ูุฑุฎ ุฏุฑุฎูุงุณุชโูุง ุฑุง ฺฉูุชุฑู ูโฺฉูุฏ.

---

### ๐ ูุญูู ุนููฺฉุฑุฏ ุงูฺฏูุฑุชู:

* ุฎุท ุฒูุงู ุจู **ุจุงุฒูโูุง ุฒูุงู ุจุง ุทูู ุซุงุจุช** (ูุซูุงู ฑ ุซุงููุ ฑ ุฏููู) ุชูุณู ูโุดูุฏ.
* ุจุฑุง ูุฑ ูพูุฌุฑูโ ุฒูุงูุ ฺฉ **ุดูุงุฑูุฏู** ุฏุฑ ูุธุฑ ฺฏุฑูุชู ูโุดูุฏ.
* **ูุฑ ุฏุฑุฎูุงุณุช ุฏุฑุงูุชุ ููุฏุงุฑ ุดูุงุฑูุฏูโ ุขู ูพูุฌุฑู ุฑุง ฺฉ ูุงุญุฏ ุงูุฒุงุด ูโุฏูุฏ.**
* ุงฺฏุฑ ููุฏุงุฑ ุดูุงุฑูุฏู ุจู ุขุณุชุงูู ุชุนูโุดุฏู (threshold) ุจุฑุณุฏุ **ุฏุฑุฎูุงุณุชโูุง ุงุถุงู ุชุง ุขุบุงุฒ ูพูุฌุฑู ุจุนุฏ ุฑุฏ ูโุดููุฏ.**

![](./Pictures/4-8.png)
---

### ๐ข ูุซุงู ููููุณ:

ูุฑุถ ฺฉูุฏ ุณุณุชู ุญุฏุงฺฉุซุฑ ุงุฌุงุฒูโ ณ ุฏุฑุฎูุงุณุช ุฏุฑ ูุฑ ุซุงูู ุฑุง ุฏุงุฑุฏ. ุฏุฑ ูุฑ ูพูุฌุฑูโ ฺฉโุซุงููโุงุ ุชููุง ณ ุฏุฑุฎูุงุณุช ูุฌุงุฒ ุงุณุช. ุงฺฏุฑ ุจุดุชุฑ ุงุฒ ณ ุฏุฑุฎูุงุณุช ูุงุฑุฏ ุดูุฏุ ูุงุจู **ุฑุฏ ูโุดููุฏ**.


---

### โ๏ธ ูุณุฆูู ููู: ูุจูโูุง ูพูุฌุฑู (Edge Effect)

ฺฉ ุงุฒ ูุดฺฉูุงุช ุงุตู ุงู ุงูฺฏูุฑุชูุ **ุชุฑุงูฺฉ ุงููุฌุงุฑ (Burst Traffic)** ุฏุฑ ูุจูโูุง ูพูุฌุฑูโูุง ุฒูุงู ุงุณุช. ุฏุฑ ุงู ุญุงูุชุ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุชโูุง ฺฉู ุงุฒ ุณุณุชู ุนุจูุฑ ูโฺฉููุฏ ููฺฉู ุงุณุช **ุจุดุชุฑ ุงุฒ ุธุฑูุช ูุฌุงุฒ** ุจุงุดุฏ.

๐ ูุซุงู:

ูุฑุถ ฺฉูุฏ ุญุฏุงฺฉุซุฑ ต ุฏุฑุฎูุงุณุช ุฏุฑ ูุฑ ุฏููู ูุฌุงุฒ ุงุณุช. ุฏุฑ ุดฺฉู **Figure 4-9**:

* ุจู ุณุงุนุช ฒ:ฐฐ:ฐฐ ุชุง ฒ:ฐฑ:ฐฐุ ูพูุฌ ุฏุฑุฎูุงุณุช ุงุฑุณุงู ุดุฏูโุงูุฏ.
* ุจู ฒ:ฐฑ:ฐฐ ุชุง ฒ:ฐฒ:ฐฐุ ูพูุฌ ุฏุฑุฎูุงุณุช ุฏฺฏุฑ ุงุฑุณุงู ุดุฏูโุงูุฏ.

ุงูุง ุฏุฑ ุจุงุฒูโ ุชุฑฺฉุจ **ฒ:ฐฐ:ณฐ ุชุง ฒ:ฐฑ:ณฐ**ุ ุนููุงู **ฑฐ ุฏุฑุฎูุงุณุช** ุนุจูุฑ ฺฉุฑุฏูโุงูุฏุ ฺฉู **ุฏู ุจุฑุงุจุฑ ุญุฏ ูุฌุงุฒ** ุงุณุช. ุงู ุงุชูุงู ุจู ุฏูู ุชูุธู ุดูุงุฑูุฏู ุจุฑ ุงุณุงุณ ุฏูููโูุง ฺฏุฑุฏ (ูุงููุฏ `HH:MM:00`) ุฑุฎ ูโุฏูุฏ ู ุจู ุขู **Edge Effect** ฺฏูุชู ูโุดูุฏ.


![](./Pictures/4-9.png)
---

### โ ูุฒุงุง (Pros):

* **ูพุงุฏูโุณุงุฒ ุณุงุฏู** ู **ุฏุฑฺฉ ุขุณุงู**.
* **ูุตุฑู ฺฉู ุญุงูุธู**ุ ุฒุฑุง ุชููุง ูุงุฒ ุจู ูฺฏูโุฏุงุดุชู ุดูุงุฑูุฏู ุจุฑุง ูุฑ ูพูุฌุฑูโ ุฒูุงู ุฏุงุฑู.
* **ููุงุณุจ ุจุฑุง ููุงุฑุฏ ฺฉู ูุญุฏูุฏุช ุฒูุงู ุฏูู** (ูุซูุงู ฑ ุฏูููโุง ุง ฑ ุณุงุนุชู) ูุงุฒ ุงุณุช ู **ุชุบุฑุงุช ูุฑุฎ ุฏุฑุฎูุงุณุชโูุง ุฎู ููู ูุณุช**.

---

### โ ูุนุงุจ (Cons):

* ุฏุฑ ูุจูโูุง ูพูุฌุฑูุ ููฺฉู ุงุณุช ุณุณุชู **ุจุด ุงุฒ ุญุฏ ูุฌุงุฒ ุฏุฑุฎูุงุณุช ุฑุง ุจูพุฐุฑุฏ** (Edge Effect).
* **ุนุฏู ุชุญูู ุงููุฌุงุฑ ุชุฑุงูฺฉ ุฏุฑ ุฒูุงู ฺฉูุชุงู**.

---

### ๐ ูฺฉุชู ุชฺฉูู:

ุงูฺฏูุฑุชู **Fixed Window** ุฒูุงู ููุฏ ุงุณุช ฺฉู:

* ุฏุฑุฎูุงุณุชโูุง ูพุฑุงฺฉูุฏฺฏ ฺฉููุงุฎุช ุฏุงุดุชู ุจุงุดูุฏ.
* ูุญุฏูุฏุช ุฏูู ู ุณุงุฏู (ูุซูุงู "ต ุฏุฑุฎูุงุณุช ุฏุฑ ุฏููู") ูููโุชุฑ ุงุฒ ฺฉูุชุฑู ุฏูู ุจุงุฑ ุฏุฑ ูุฑ ูุญุธู ุจุงุดุฏ.

ุฏุฑ ุบุฑ ุงูโุตูุฑุชุ ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชูโูุง ูุซู **Sliding Window** ุง **Token Bucket** ุจุฑุง ฺฉูุชุฑู ุจูุชุฑ ุจุงุฑ ู ฺฉุงูุด ูุดฺฉูุงุช ูุจูโุง ุชูุตู ูโุดูุฏ.

---

๐ ููุงุจุน:

* [Rate Limiting Strategies and Algorithms - Cloudflare](https://blog.cloudflare.com/counting-things-a-lot-of-different-things/)
* [API Rate Limiting โ Stripe](https://stripe.com/docs/rate-limits)
* [YouTube Engineering โ Throttle Requests at Scale](https://youtubeeng.blogspot.com/2017/07/how-youtube-scales-rate-limiting.html)

---

ุฏุฑ ุจุฎุด ุจุนุฏุ ุงูฺฏูุฑุชู Sliding Window ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏ ฺฉู ุณุน ูโฺฉูุฏ ูุดฺฉู ูุจูโ ูพูุฌุฑูโูุง ุฏุฑ ุงู ุฑูุด ุฑุง ุจุฑุทุฑู ููุงุฏ.
